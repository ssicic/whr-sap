---
title: "World Happiness Report"
author: "X Æ A-Xii"
date: "6.12.2021."
output: pdf_document
---
```{r setup, include=FALSE} 

library("readxl")
```
## Motivacija i opis problema
World Happiness Report je publikacija Mreže rješenja za održivi razvoj Ujedinjenih naroda koja sadrži po-
datke o osjećaju sreće pojedinih nacija. Podatci su dobiveni kroz ankete koje provode Gallup i Lloyd’s
Register Foundation. Prvi je izvještaj objavljen 2012. godine, a od 2016. se objavljuje na Međunarodni dan
sreće 20. ožujka.

### Učitavanje podataka o svjetskom bogatstvu 2021. godine

```{r wealth} 
wealth_data <- read_excel("E:/FER/Statistička analiza podataka/Projekt/files/credit_suisse_global_wealth_databook_2021_table_31.xlsx")

dim(wealth_data)
head(wealth_data)
```


### Učitavanje podataka o globalnoj sreći 2020. godine

You can also embed plots, for example:

```{r whr 2020}
whr2020_data <- read_excel("E:/FER/Statistička analiza podataka/Projekt/files/WHR_2020.xlsx")

dim(whr2020_data)
head(whr2020_data)
```

### Učitavanje podataka o globalnoj sreći 2021. godine

You can also embed plots, for example:

```{r whr 2021}
whr2021_data <- read_excel("E:/FER/Statistička analiza podataka/Projekt/files/WHR_2021.xlsx")

dim(whr2021_data)
head(whr2021_data)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


### Postoje li razlike u iskazanoj sreći medu različitim regijama?

Na ovo pitanje ćemo odgovoriti korištenjem jednofaktorskom ANOVA metodom.
  

U sljedećem isječku ćemo prikazati box plot dijagrame sreće po pojedinim regijama.

```{r boxplot for ladder scores}

par(mar=c(15,5,1,1))
boxplot(`Ladder score`~`Regional indicator`,data = whr2021_data, las = 2, xlab = "" )

```

Boxplot nas upućuje da postoje razlike u iskazanim srećama po regijama.
To ćemo potvrditi ANOVA metodom.

Uvjeti za ANOVA-u su normalnost i nezavisnost podataka, te homogenost varijanci među regijama.
Nezavisnost podataka možemo pretpostaviti. 
Normalnost podataka po regijama ćemo provjeriti s Kolmogorov-Smirnovim testom.Hipoteze su nam sljedeće:
$$ \begin{aligned}
H_0&: \text{podaci su normalno distribuirani} \\
H_1&: \text{podaci nisu normalno distribuirani} \\
\end{aligned} $$
te $$ \alpha = 0.05 $$
```{r ks test for all regions for ladder score}

ks.test(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Central and Eastern Europe'], "pnorm", mean(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Central and Eastern Europe']),sd(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Central and Eastern Europe']))
hist(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Central and Eastern Europe'])

ks.test(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Commonwealth of Independent States'], "pnorm", mean(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Commonwealth of Independent States']),sd(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Commonwealth of Independent States']))
hist(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Commonwealth of Independent States'])

ks.test(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='East Asia'], "pnorm", mean(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='East Asia']),sd(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='East Asia']))
hist(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='East Asia'])

ks.test(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Latin America and Caribbean'], "pnorm", mean(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Latin America and Caribbean']),sd(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Latin America and Caribbean']))
hist(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Latin America and Caribbean'])

ks.test(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Middle East and North Africa'], "pnorm", mean(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Middle East and North Africa']),sd(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Middle East and North Africa']))
hist(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Middle East and North Africa'])

ks.test(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='North America and ANZ'], "pnorm", mean(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='North America and ANZ']),sd(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='North America and ANZ']))
hist(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='North America and ANZ'])

ks.test(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='South Asia'], "pnorm", mean(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='South Asia']),sd(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='South Asia']))
hist(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='South Asia'])

ks.test(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Southeast Asia'], "pnorm", mean(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Southeast Asia']),sd(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Southeast Asia']))
hist(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Southeast Asia'])

ks.test(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Sub-Saharan Africa'], "pnorm", mean(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Sub-Saharan Africa']),sd(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Sub-Saharan Africa']))
hist(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Sub-Saharan Africa'])

ks.test(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Western Europe'], "pnorm", mean(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Western Europe']),sd(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Western Europe']))
hist(whr2021_data$`Ladder score`[whr2021_data$`Regional indicator`=='Western Europe'])

```
P-vrijednosti na svim testovima su nam veće od kritične vrijednosti te ne odbijamo nul hipotezu.

Sada trebamo analizirati homogenost varijanci regija što ćemo napraviti s Bartlettovim testom. Hipoteze su nam sljedeće:
$$ \begin{aligned}
  H_0 & : \sigma_1^2 = \sigma_2^2 = \ldots = \sigma_k^2 \\
  H_1 & : \neg H_0.
\end{aligned} $$
te $$ \alpha = 0.05 $$

```{r bartlett test for all regions for ladder score}
bartlett.test(whr2021_data$`Ladder score` ~ whr2021_data$`Regional indicator`)
```
P-vrijednost je manja od kritične vrijednosti tako da ne odbacujemo nul hipotezu.

Sada možemo napraviti jednofaktorsku ANOVA-u. Hipoteze su nam sljedeće:
$$ \begin{aligned}
  H_0 & : \mu_1 = \mu_2 = \ldots = \mu_k \\
  H_1 & : \neg H_0.
\end{aligned} $$
te $$ 
  \alpha = 0.05\\
  k = 10
 $$
```{r ANOVA for lader score }
luck = aov(whr2021_data$`Ladder score` ~ whr2021_data$`Regional indicator`)
summary(luck)
```
Kao što je sugerirano u grafu s početka, ANOVA potvrđuje da postoji razlika u iskazanoj sreći među regijama.